{
    "apiVersion": "2015-06-15",
    "type": "Microsoft.Compute/virtualMachines/extensions",
    "name": "[concat('$HOSTNAME', '/SqlIaasExtension')]",
    "location": "[variables('location')]",
    "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', '$HOSTNAME')]"
    ],
    "properties": {
        "type": "SqlIaaSAgent",
        "publisher": "Microsoft.SqlServer.Management",
        "typeHandlerVersion": "1.2",
        "autoUpgradeMinorVersion": "true",
        "settings": {
            "AutoTelemetrySettings": {
                "Region": "[variables('location')]"
            },
            "AutoPatchingSettings": {
                "PatchCategory": "WindowsMandatoryUpdates",
                "Enable": true,
                "DayOfWeek": "Sunday",
                "MaintenanceWindowStartingHour": "2",
                "MaintenanceWindowDuration": "60"
            },
            "KeyVaultCredentialSettings": {
                "Enable": false,
                "CredentialName": ""
            },
            "ServerConfigurationsManagementSettings": {
                "SQLConnectivityUpdateSettings": {
                    "ConnectivityType": "Private",
                    "Port": "1433"
                },
                "SQLWorkloadTypeUpdateSettings": {
                    "SQLWorkloadType": "GENERAL"
                },
                "SQLStorageUpdateSettings": {
                    "DiskCount": "1",
                    "NumberOfColumns": "1",
                    "StartingDeviceID": "2",
                    "DiskConfigurationType": "NEW"
                },
                "AdditionalFeaturesServerConfigurations": {
                    "IsRServicesEnabled": "false"
                }
            }
        },
        "protectedSettings": {}
    }
}